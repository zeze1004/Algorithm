import sys
from collections import deque

input = sys.stdin.readline

X, Y = map(int, input().split())
que = deque()

tomato_map = [list(map(int, input().split())) for _ in range(Y)]
# ì•ˆ ìµì€ í† ë§ˆí† ê°€ ìµì€ ì‹œê°„ì„ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
# í•˜ì§€ë§Œ ì“¸ëª¨ ì—†ì—ˆë‹¤ğŸ˜¢
time = [[0] * X for _ in range(Y)]

# ìƒí•˜ì¢Œìš°
dx = [0, 0, -1, 1]
dy = [1, -1, 0, 0]

def bfs():
    count = 0
    while que:
        count += 1
        # íì˜ ê¸¸ì´(ìµì€ í† ë§ˆí†  ê°¯ìˆ˜)ë§Œí¼ ìµì€ í† ë§ˆí†  ì£¼ì˜ë¥¼ íƒìƒ‰í•˜ì§€ ì•Šìœ¼ë©´ 0ì´ ë‚˜ì˜¤ì§€ ì•Šì„ ë•Œê¹Œì§€
        # ëë„ ì—†ì´ íƒìƒ‰í•´ì„œ count ìˆ˜ê°€ ìŠ‰ìŠ‰ ì¦ê°€í•¨ğŸ˜¢
        # íì˜ ê¸¸ì´ë§Œí¼ íƒìƒ‰í•´ì•¼ 1ì˜ ìƒí•˜ì¢Œìš°ë§Œ íƒìƒ‰í•  ìˆ˜ ìˆìŒ
        for _ in range(len(que)):
            y, x = que.popleft()
            for i in range(4):
                move_x = x + dx[i]
                move_y = y + dy[i]

                if (0 <= move_x < X) and (0 <= move_y < Y):
                    if tomato_map[move_y][move_x] == 0 and time[move_y][move_x] == 0:
                        tomato_map[move_y][move_x] = 1
                        time[move_y][move_x] = time[y][x] + 1
                        que.append((move_y, move_x))
    # ì²˜ìŒ ìµì€ í† ë§ˆí† ê¹Œì§€ 1ë¡œ ì¹´ìš´íŒ… ë¼ì„œ í•˜ë‚˜ ë¹¼ì¤˜ì•¼ í•¨
    return count - 1

for i in range(Y):
    for j in range(X):
        if tomato_map[i][j] == 1 and time[i][j] == 0:
            que.append((i, j))

result = bfs()

# ì¶œë ¥
# í•˜ë‚˜ë¡œ ì•ˆ ìµì€ í† ë§ˆí† ê°€ ìˆìœ¼ë©´ -1 ì¶œë ¥í•˜ê³  ëë‚´ê¸°
for i in range(Y):
    for j in range(X):
       if tomato_map[i][j] == 0: 
           print(-1)
           exit(0)

print(result)



